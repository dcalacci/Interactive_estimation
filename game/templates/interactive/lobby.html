{% extends 'base.html' %}
{% load staticfiles %}

{% block breadcrumbs %}
<div id="breadcrumbs" hidden="true">
  <ul class="nav nav-wizard">
    <li>Current Round: <span id="currentRound"></span></li>
    <li id="initial"><a>Initial Guess</a></li>
    <li id="interactive"><a>Interactive Guess</a></li>
    <li id="outcome"><a>Round Outcome</a></li>
  </ul>
</div>
{% endblock %}

{% block container %}
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"/>

<div id="lobby" class="container">
    <div class="row" style="margin-bottom: 30px;">
        <div class="col-md-12 text-center">
            <h2 class="text-center"> You're in the assignment lobby! </h2>
            {% if not request.groupId %}
            <p> We're waiting on a few more people to join the lobby.</p>
            {% else %}
        </div>
    </div>
    <div class="row">
        <div class="col-md-6 col-md-offset-3">
            <h3> We're waiting on the rest of your group to join the lobby before you start the assignment. </h3>
            <p> As group members join the lobby, you should be able to chat with
                them over videoconference below. When you all agree that the group is
                ready to start the assignment, one of you should click "start
                assignment" below to begin!</p>
            <p> Make sure that your video and audio work by looking at the box
            on the right. The page should ask for access to your camera, and you
            should see a green outline around the video feed when you speak. Try
            it out!</p>
        </div>
        <div class="col-md-6">
            <p class="text-center">
                This is how you will look to other students!
            </p>
            <video id="userBox" class="responsive-video" muted volume="0" width="237" height="180"></video>
            <div id="videoHolder">
                <p class="text-center" id="videoHolderText">
                    Enable your webcam!
                </p>
            </div>
            
        </div>
    </div>
    {% endif %}

    {%include 'components/video.html' %}

    <div class="row">
        <div class="col-md-12">
            {% if not request.linkedId %}
            We don't have a linked ID for you..
            {% else %}
            We think you're have a linked ID '{{request.linkedId}}'.
            {% endif %}
        </div>
    </div>
  <div class="row">
      <div class="col-md-12" id="waiting">
          There are currently <span id="connected_players">0</span> group
          members in the lobby. We think you're in group '{{request.groupId}}'.
  </div>
  
  </div>
</div>

<div id="game" hidden>
  <div class="form">
    <div class="col-md-4 guess" hidden>
      <div>
          <img src='#' class="img-responsive" style="width: 100%"/>
      </div>
      <div id="picker">
        {% include 'components/slider.html' %}
        <input type="submit" value="Next" id="submit" class="btn btn-primary nextButton">
      </div>
    </div>

    <div class="col-md-5 outcome" hidden>
      <div>
        <img src='#' class="img-responsive" style="width: 100%"/>
      </div>
      <div>
        Your guess: <span id="yourGuess"></span>
      </div>

      <div>
        Actual correlation: <span id="roundAnswer"></span>
      </div>
      <input type="submit" value="Next" id="submit" class="btn btn-primary nextButton">
    </div>


    <div class="col-md-5">
      <div class="outcome" hidden>
        <b>You are following:</b>
        <div>User Scores</div>
        <table class="table table-bordered" id="unfollow_list">
          <tbody>
          </tbody>
        </table>
      </div>

      <!-- insert video here -->
      <div id="interactiveGuess" hidden>
          {%include 'components/video.html' %}
        <div>User Guesses</div>
        <table class="table table-bordered" id="following_list">
          <tbody>
          </tbody>
        </table>
      </div>
      {% include 'components/timer.html' %}
    </div>

    <div class="col-md-5">
      <div class="outcome" hidden>
        <b>You can follow:</b>
        <div id="follow_list">
        </div>
      </div>
    </div>
    
    <div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
          <div class="modal-body">
            Waiting for other players...
            <img src='/static/images/loading.gif' class="loading"/>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


{% endblock %}


{% block extra_javascript %}
<script src="{% static "js/reconnecting-websocket.min.js" %}" type="text/javascript"></script>
<script>
 var groupId = "{{request.groupId}}" == "" ? null : "{{request.groupId}}"
 var linkedId = "{{request.linkedId}}" == "" ? null : "{{request.linkedId}}"
</script>

<script src="{% static "js/interactive.js" %}"></script>
<script type="text/javascript" src="{% static "rtcjs/easyrtc.js" %}"></script>
<script type="text/javascript" src="{% static "rtcjs/socket.io.js" %}"></script>
<script type="text/javascript" src="{% static "js/main.js" %}"></script>

{% endblock %}
